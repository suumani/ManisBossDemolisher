# Documentation Policy — Manis Boss Demolisher

本ディレクトリは、Manis Boss Demolisher における設計・仕様・テストの拠り所を体系的に保存するためのものである。
本書は、開発が迷走した場合に必ず立ち返るべき一次資料として位置づけられる。

## 1. 文書の役割分担

本プロジェクトでは、以下の3種類の文書を明確に分離して管理する。


## 0. ファイル一覧


/docs/SystemSpecification/配下
```
00_Overview.md 全体
01_InvasionExport.md 輸出機能
02_PlanetStateModel.md 惑星の状態
03_RocketSoundReaction.md ロケット発射音への反応(デモリッシャー移動機能)
04_BossClasses.md ボスの種類
90_Observability.md 観測可能性
99_TestPlan.md テスト計画
99_TestStatus_Summary.md テストサマリ
```

/配下
```
spec.ja.md
spec.md
README.ja.md
README.md
```


### 1.1 spec.ja.md（ユーザ向け一次仕様）

 - 対象読者：
   - プレイヤー
   - Mod利用者
   - 将来の自分（世界観・意図を忘れたとき）
 - 内容：
   - 目的 / 非目的
   - プレイヤー体験
   - 設計思想・優先順位
   - 世界観上の前提
 - 記載しないもの：
   - 条件分岐の詳細
   - 状態遷移表
   - 数式・上限・内部判定
   - テスト観点

👉 spec.ja.md は「なぜそうなっているか」を語る文書である。

### 1.2 docs/SystemSpecification（システム仕様・テスト根拠）

 - 対象読者：
   - 開発者
   - テスト設計者
   - 将来の自分（実装を忘れたとき）
 - 内容：
   - 合否条件が明確な仕様
   - 状態遷移・入力・出力
   - 上限・抑止・例外条件
   - 観測点（ログ・カウンタ）
   - テスト計画と網羅方針
 - ルール：
   - すべての仕様項目にIDを付与する
   - テストケース・ログは必ずこのIDを参照する

👉 テストは必ず SystemSpecification を根拠として作成される。

## 1.3 docs/DesignNotes（設計メモ・検討ログ / 任意）

 - 対象読者：
   - 開発者のみ
 - 内容：
   - 実装上の制約
   - 検討中の案
   - 却下された設計
 - 注意：
   - 仕様ではない
   - テストの根拠にしてはならない

👉 DesignNotes は意思決定の履歴であり、正解ではない。

## 2. 優先順位と矛盾解決ポリシー

文書間に矛盾が生じた場合、以下の優先順位で判断する。

 1. spec.ja.md（ユーザ向け一次仕様）
 2. SystemSpecification（システム仕様）
 3. DesignNotes（設計メモ）

ただし、挙動を変更する決定を行った場合は、
 - spec.ja.md
 - 該当する SystemSpecification

両方を必ず更新すること。
片方のみの更新は不正とみなす。

## 3. テストに関する基本方針
### 3.1 テストは「仕様」から起こす

 - 仕様が未定義の箇所にテストを作ってはならない
 - 実装を読んでテストを書くことは禁止する
 - テストは 仕様の合否を確認するためのものである

### 3.2 ゲーム挙動テストを主とする
 - 本プロジェクトにおける主対象は ゲームとしての挙動
   - 侵略が起きるか
   - 起きないべきときに起きないか
   - 上限が守られているか
   - 沈黙・暴走・ロストがないか
 - 低レイヤーの単体テストは原則作成しない
   - 必要な場合は ログ・観測点の追加を優先する

### 3.3 低レイヤーテストを作る条件

以下をすべて満たす場合のみ、低レイヤーテストを検討する。

 - ゲーム挙動テストで 明確なNGが出た
 - 原因が低レイヤー処理であると特定できた
 - 仕様として再発防止が必要である

## 4. このドキュメントの位置づけ

 - 本書は「作業が迷走したときの原点」である
 - テストや実装が増え、不安や違和感を覚えた場合：
   1. 本書に立ち返る
   2. spec.ja.md と SystemSpecification の役割を再確認する
   3. 仕様に基づかない作業を中断する

👉 この文書に反する進め方は、たとえ動いていても不正である。

## 5. 更新ルール

 - 本書の更新は慎重に行う
 - 方針が変わる場合は、必ず理由を明示する
 - 更新履歴は DesignNotes に残してよいが、本書自体は常に最新の方針のみを記載する

## 最後に

本プロジェクトでは、

 > 「動いている」よりも「意図通りである」ことを優先する。

この原則を忘れたとき、本書に立ち返る。